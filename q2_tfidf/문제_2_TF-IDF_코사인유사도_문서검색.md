## 문항 2: TF-IDF 직접 구현 및 코사인 유사도 기반 문서 검색

### [ 시험 정보 ]
| 항목 | 내용 |
|------|------|
| 과정 | AI 올인원 |
| 단계 | AI/SW 심화 |
| 난이도 | 1 |
| 권장 시간 | 15분 |
| 관련 과목 | 자연어 처리, 데이터 분석, AI 수학 |
| Pass 기준 | 정답 체크리스트 6개 중 6개 모두 충족 |

---

### [ 문제 ]

당신은 사내 문서 검색 시스템을 구축하는 엔지니어입니다.
20개의 한국어 기술 문서(`documents.txt`)가 주어지며, 사용자의 검색 쿼리에 **가장 유사한 문서 상위 3개**를 반환하는 시스템을 만들어야 합니다.

다음 요구사항을 모두 충족하는 Python 스크립트 `q2_solution.py`를 작성하십시오.

---

### [ 요구사항 ]

1. **텍스트 전처리 함수 `preprocess(text)`를 구현하세요:**
   - (a) 모든 텍스트를 **소문자로 변환**
   - (b) 정규표현식(`re`)을 사용하여 **한글, 영문, 숫자를 제외한 모든 문자를 제거**
   - (c) **공백 기준**으로 토큰화
   - (d) `stopwords.txt`에 포함된 토큰을 **제거**
   - (e) **길이 1 이하**인 토큰을 제거

2. **TF (Term Frequency) 계산**
   ```
   TF(t, d) = count(t in d) / total_words(d)
   ```
   각 문서에서 각 단어의 등장 빈도를 해당 문서의 전체 단어 수로 나눈 값입니다.

3. **IDF (Inverse Document Frequency) 계산 — Smooth IDF 적용**
   ```
   IDF(t) = log((N + 1) / (df(t) + 1)) + 1
   ```
   - `N` = 전체 문서 수
   - `df(t)` = 단어 t가 등장하는 문서 수
   - `log` = 자연로그 (`np.log`)

4. **TF-IDF 행렬 생성**
   - NumPy 배열로 **(문서 수 × 단어 수)** 크기의 행렬을 생성하세요.
   - 단어(열) 순서는 전체 코퍼스의 단어를 **사전순(알파벳/한글순)**으로 정렬하세요.

5. **코사인 유사도 함수 `cosine_similarity(a, b)`를 구현하세요:**
   ```
   cosine_sim(a, b) = dot(a, b) / (norm(a) * norm(b))
   ```
   - 두 벡터 중 하나라도 **영벡터**(norm=0)이면 유사도는 **0.0**으로 반환

6. **검색 함수 `search(query_text, top_n=3)`를 구현하세요:**
   - 쿼리 문자열에 동일한 전처리 및 TF-IDF 변환을 적용
   - 각 문서와의 코사인 유사도를 계산하여 **상위 3개 문서**의 인덱스와 유사도를 반환

---

### [ 제약 사항 ]
- **NumPy만 사용**하여 모든 수치 계산 수행 (`sklearn`, `scipy` 금지)
- 정규표현식은 `re` 모듈 사용
- **Smooth IDF 수식**을 정확히 적용할 것 (일반 IDF가 아닌 위 수식)
- 쿼리의 IDF는 **기존 코퍼스 기준**으로 계산 (쿼리를 코퍼스에 추가하지 않음)

---

### [ 입력 형식 ]

| 파일 | 설명 |
|------|------|
| `documents.txt` | 한 줄에 하나의 문서 (총 20줄) |
| `stopwords.txt` | 한 줄에 하나의 불용어 |
| `queries.txt` | 한 줄에 하나의 검색 쿼리 (총 5개) |

---

### [ 출력 형식 ]

`result_q2.json` 파일로 다음 구조를 저장하세요:

```json
{
  "vocab_size": 정수,
  "tfidf_matrix_shape": [정수, 정수],
  "search_results": [
    {
      "query": "쿼리 텍스트",
      "top3": [
        {"doc_index": 정수, "similarity": 실수},
        {"doc_index": 정수, "similarity": 실수},
        {"doc_index": 정수, "similarity": 실수}
      ]
    },
    ...
  ]
}
```

- 모든 유사도는 **소수점 이하 6자리**로 반올림

---

### [ 제출 방식 ]
- `q2_solution.py` 파일과 `result_q2.json` 파일을 함께 제출
